<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>index</title>
    <link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <!--<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>-->
    <!--<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
    <!-- styles -->
    <link rel="stylesheet" href="../fileCss/bootstrap.min.css">
    <link rel="stylesheet" href="../fileCss/jquery.dataTables.css">
    <link rel="stylesheet" href="../fileCss/dataTables.bootstrap.css">
    <link rel="stylesheet" href="../fileCss/bootstrap-datepicker.min.css">
    <!-- scripts -->
    <script src="../fileJs/jquery-1.12.4.min.js"></script>
    <script src="../fileJs/bootstrap.min.js"></script>
    <script src="../fileJs/jquery.dataTables.js"></script>
    <script src="../fileJs/dataTables.bootstrap.js"></script>
    <script src="../fileJs/bootstrap-datepicker.js"></script>
    <style>
        body {
            padding: 10px;
        }
        
        h3 {
            font-style: italic;
            color: deeppink;
            font-family: monospace, monospace;
            display: inline-block;
        }
        
        #box {
            padding: 30px;
            border: 1px solid #ff0000;
        }
        
        #tableId_paginate li {
            padding: 0;
            margin: 0;
            border: none;
        }
        
        table.dataTable thead .sorting_asc:after {
            color: blue;
        }
        
        table.dataTable thead .sorting:after {
            color: red;
        }
    </style>
</head>
<body>
<h3>nav</h3>
<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">菜鸟教程</a>
        </div>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="#"><span class="glyphicon glyphicon-user"></span> 注册</a></li>
            <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> 登录</a></li>
        </ul>
    </div>
</nav>

<h3>datePicker</h3>
<div class="input-group date" data-provide="datepicker" style="width: 300px;">
    <input type="text" class="form-control" data-date-end-date="0d">
    <div class="input-group-addon">
        <span class="glyphicon glyphicon-th"></span>
    </div>
</div>


<h3>查询</h3>
<div class="" style="padding: 20px; border: 1px solid deeppink;">
    <!--<div class="">-->
    <!--<form action="" method="">-->
    <!--<div class="input-group">-->
    <!--<input type="text" class="form-control" name=""   placeholder="请输入要查询的部门...">-->
    <!--<span class="input-group-btn">-->
    <!--<button class="btn btn-default">-->
    <!--<span class=""></span>-->
    <!--&nbsp;查询-->
    <!--</button>-->
    <!--</span>-->
    <!--</div>-->
    <!--</form>-->
    <!--</div>-->
    <!--<div class="">-->
    <!--<button type="button" class="btn btn-primary">添加</button>-->
    <!--</div>-->
</div>

<h3>table</h3>
<div id="box">
    <table id="tableId" class="display table table-hover table-striped table-bordered table-condensed">
        <!--<th style="width: 50px;"><input type="checkbox"></th>-->
        <thead>
        <tr>
            <th>Name</th>
            <th>Position</th>
            <th>Office</th>
            <th>Extn.</th>
            <th>Start date</th>
            <!--<th>time</th>-->
            <th>Salary</th>
        </tr>
        </thead>
    </table>
</div>

<h3>下拉框组</h3> <span>下拉框不显示</span>
<div style="padding: 10px;">
    <form class="bs-example bs-example-form" role="form">
        <div class="">
            <div class="">
                <div class="input-group">
                    <div class="input-group-btn">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            下拉菜单
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a href="#">功能</a></li>
                            <li><a href="#">另一个功能</a></li>
                            <li><a href="#">其他</a></li>
                            <li class="divider"></li>
                            <li><a href="#">分离的链接</a></li>
                        </ul>
                    </div><!-- /btn-group -->
                    <input type="text" class="form-control">
                </div><!-- /input-group -->
            </div><!-- /.col-lg-6 --><br>
            <div class="">
                <div class="input-group">
                    <input type="text" class="form-control">
                    <div class="input-group-btn">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            下拉菜单
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu pull-right">
                            <li><a href="#">功能</a></li>
                            <li><a href="#">另一个功能</a></li>
                            <li><a href="#">其他</a></li>
                            <li class="divider"></li>
                            <li><a href="#">分离的链接</a></li>
                        </ul>
                    </div><!-- /btn-group -->
                </div><!-- /input-group -->
            </div><!-- /.col-lg-6 -->
        </div><!-- /.row -->
    </form>
</div>

<h3>面板 panel</h3>
<div class="panel panel-default" style=" margin: 20px;">
    <div class="panel-heading">
        <h3 class="panel-title">
            panel-title
        </h3>
    </div>
    <div class="panel-body">
        这是一个基本的面板
    </div>
    <div class="panel-footer">
        面板脚注
    </div>
</div>

</body>
</html>
<script>
// $.fn.dataTableExt.oApi.fnPagingInfo = function ( oSettings )
// {
//         return {
//                 "iStart":         oSettings._iDisplayStart,
//                 "iEnd":           oSettings.fnDisplayEnd(),
//                 "iLength":        oSettings._iDisplayLength,
//                 "iTotal":         oSettings.fnRecordsTotal(),
//                 "iFilteredTotal": oSettings.fnRecordsDisplay(),
//                 "iPage":          oSettings._iDisplayLength === -1 ?
//                     0 : Math.ceil( oSettings._iDisplayStart / oSettings._iDisplayLength ),
//                 "iTotalPages":    oSettings._iDisplayLength === -1 ?
//                     0 : Math.ceil( oSettings.fnRecordsDisplay() / oSettings._iDisplayLength )
//         };
//     }
//
// /* Bootstrap style pagination control */
// $.extend( $.fn.dataTableExt.oPagination, {
//         "bootstrap": {
//             "fnInit": function( oSettings, nPaging, fnDraw ) {
//                     var oLang = oSettings.oLanguage.oPaginate;
//                     var fnClickHandler = function ( e ) {
//                             e.preventDefault();
//                             if ( oSettings.oApi._fnPageChange(oSettings, e.data.action) ) {
//                                     fnDraw( oSettings );
//                                 }
//                         };
//
//                     $(nPaging).addClass('pagination').append(
//                             '<ul>' +
//                         '<li ><a  > ' + oLang.sFirst + '</a></li>' + //添加首页显示
//                            '<li ><a  > ' + oLang.sPrevious + '</a></li>' + // '<li ><a  >&larr; '+oLang.sPrevious+'</a></li>'+
//                            '<li ><a  >' + oLang.sNext + '</a></li>' + // '<li ><a  >'+oLang.sNext+' &rarr; </a></li>'+
//                            '<li ><a  > ' + oLang.sLast + '</a></li>' + //添加尾页显示
//                         '</ul>'
//                     );
//                     var els = $('a', nPaging);
//                     $(els[0]).bind('click.DT', { action: "first" }, fnClickHandler); //绑定首页事件
//                     $(els[1]).bind('click.DT', { action: "previous" }, fnClickHandler);
//                     $(els[2]).bind('click.DT', { action: "next" }, fnClickHandler);
//                     $(els[3]).bind('click.DT', { action: "last" }, fnClickHandler);//绑定尾页事件
//                     //$(els[0]).bind( 'click.DT', { action: "previous" }, fnClickHandler );
//                     //$(els[1]).bind( 'click.DT', { action: "next" }, fnClickHandler );
//                 },
//
//             "fnUpdate": function ( oSettings, fnDraw ) {
//                     var iListLength = 5;
//                     var oPaging = oSettings.oInstance.fnPagingInfo();
//                     var an = oSettings.aanFeatures.p;
//                     var i, j, sClass, iStart, iEnd, iHalf=Math.floor(iListLength/2);
//
//                     if ( oPaging.iTotalPages < iListLength) {
//                             iStart = 1;
//                             iEnd = oPaging.iTotalPages;
//                         }
//                     else if ( oPaging.iPage <= iHalf ) {
//                             iStart = 1;
//                             iEnd = iListLength;
//                         } else if ( oPaging.iPage >= (oPaging.iTotalPages-iHalf) ) {
//                             iStart = oPaging.iTotalPages - iListLength + 1;
//                             iEnd = oPaging.iTotalPages;
//                         } else {
//                             iStart = oPaging.iPage - iHalf + 1;
//                             iEnd = iStart + iListLength - 1;
//                         }
//
//                     for ( i=0, iLen=an.length ; i<iLen ; i++ ) {
//                             // Remove the middle elements
//                             $('li:gt(1)', an[i]).filter(':lt(-2)').remove(); // 此处修改 $('li:gt(0)', an[i]).filter(':not(:last)').remove();
//
//                             // Add the new list items and their event handlers
//                             for ( j=iStart ; j<=iEnd ; j++ ) {
//                                     sClass = (j==oPaging.iPage+1) ? '' : '';
//                                     $('<li '+sClass+'><a  >'+j+'</a></li>')
//                                         .insertBefore($('li:eq(-2)', an[i])[0])//此处修改 .insertBefore($('li:last', an[i])[0])
//                                         .bind('click', function (e) {
//                                                 e.preventDefault();
//                                                 oSettings._iDisplayStart = (parseInt($('a', this).text(),10)-1) * oPaging.iLength;
//                                                 fnDraw( oSettings );
//                                             } );
//                                 }
//
//                             // Add / remove disabled classes from the static elements
//                             if ( oPaging.iPage === 0 ) {
//                                     $('li:lt(2)', an[i]).addClass('disabled'); //此处修改 $('li:first', an[i]).addClass('disabled');
//                                 } else {
//                                     $('li:lt(2)', an[i]).removeClass('disabled'); //此处修改 $('li:first', an[i]).removeClass('disabled');
//                                 }
//
//                             if ( oPaging.iPage === oPaging.iTotalPages-1 || oPaging.iTotalPages === 0 ) {
//                                     $('li:gt(-3)', an[i]).addClass('disabled'); //此处修改 $('li:last', an[i]).addClass('disabled');
//                                 } else {
//                                     $('li:gt(-3)', an[i]).removeClass('disabled'); //此处修改 $('li:last', an[i]).removeClass('disabled');
//                                 }
//                         }
//                 }
//         }
// } );
</script>


<script>
    $(function () {
        $.fn.dataTableExt.oApi.fnPagingInfo = function ( oSettings )
        {
            return {
                "iStart":         oSettings._iDisplayStart,
                "iEnd":           oSettings.fnDisplayEnd(),
                "iLength":        oSettings._iDisplayLength,
                "iTotal":         oSettings.fnRecordsTotal(),
                "iFilteredTotal": oSettings.fnRecordsDisplay(),
                "iPage":          oSettings._iDisplayLength === -1 ?
                    0 : Math.ceil( oSettings._iDisplayStart / oSettings._iDisplayLength ),
                "iTotalPages":    oSettings._iDisplayLength === -1 ?
                    0 : Math.ceil( oSettings.fnRecordsDisplay() / oSettings._iDisplayLength )
            };
        }
    
        /* Bootstrap style pagination control */
        $.extend( $.fn.dataTableExt.oPagination, {
            "bootstrap": {
                "fnInit": function( oSettings, nPaging, fnDraw ) {
                    var oLang = oSettings.oLanguage.oPaginate;
                    var fnClickHandler = function ( e ) {
                        e.preventDefault();
                        if ( oSettings.oApi._fnPageChange(oSettings, e.data.action) ) {
                            fnDraw( oSettings );
                        }
                    };

                    $(nPaging).addClass('pagination').append(
                        '<ul>' +
                        '<li ><a  > ' + oLang.sFirst + '</a></li>' + //添加首页显示
                        '<li ><a  > ' + oLang.sPrevious + '</a></li>' + // '<li ><a  >&larr; '+oLang.sPrevious+'</a></li>'+
                        '<li ><a  >' + oLang.sNext + '</a></li>' + // '<li ><a  >'+oLang.sNext+' &rarr; </a></li>'+
                        '<li ><a  > ' + oLang.sLast + '</a></li>' + //添加尾页显示
                        '</ul>'
                    );
                    var els = $('a', nPaging);
                    $(els[0]).bind('click.DT', { action: "first" }, fnClickHandler); //绑定首页事件
                    $(els[1]).bind('click.DT', { action: "previous" }, fnClickHandler);
                    $(els[2]).bind('click.DT', { action: "next" }, fnClickHandler);
                    $(els[3]).bind('click.DT', { action: "last" }, fnClickHandler);//绑定尾页事件
                    //$(els[0]).bind( 'click.DT', { action: "previous" }, fnClickHandler );
                    //$(els[1]).bind( 'click.DT', { action: "next" }, fnClickHandler );
                },

                "fnUpdate": function ( oSettings, fnDraw ) {
                    var iListLength = 5;
                    var oPaging = oSettings.oInstance.fnPagingInfo();
                    var an = oSettings.aanFeatures.p;
                    var i, j, sClass, iStart, iEnd, iHalf=Math.floor(iListLength/2);

                    if ( oPaging.iTotalPages < iListLength) {
                        iStart = 1;
                        iEnd = oPaging.iTotalPages;
                    }
                    else if ( oPaging.iPage <= iHalf ) {
                        iStart = 1;
                        iEnd = iListLength;
                    } else if ( oPaging.iPage >= (oPaging.iTotalPages-iHalf) ) {
                        iStart = oPaging.iTotalPages - iListLength + 1;
                        iEnd = oPaging.iTotalPages;
                    } else {
                        iStart = oPaging.iPage - iHalf + 1;
                        iEnd = iStart + iListLength - 1;
                    }

                    for ( i=0, iLen=an.length ; i<iLen ; i++ ) {
                        // Remove the middle elements
                        $('li:gt(1)', an[i]).filter(':lt(-2)').remove(); // 此处修改 $('li:gt(0)', an[i]).filter(':not(:last)').remove();

                        // Add the new list items and their event handlers
                        for ( j=iStart ; j<=iEnd ; j++ ) {
                            sClass = (j==oPaging.iPage+1) ? '' : '';
                            $('<li '+sClass+'><a  >'+j+'</a></li>')
                                .insertBefore($('li:eq(-2)', an[i])[0])//此处修改 .insertBefore($('li:last', an[i])[0])
                                .bind('click', function (e) {
                                    e.preventDefault();
                                    oSettings._iDisplayStart = (parseInt($('a', this).text(),10)-1) * oPaging.iLength;
                                    fnDraw( oSettings );
                                } );
                        }

                        // Add / remove disabled classes from the static elements
                        if ( oPaging.iPage === 0 ) {
                            $('li:lt(2)', an[i]).addClass('disabled'); //此处修改 $('li:first', an[i]).addClass('disabled');
                        } else {
                            $('li:lt(2)', an[i]).removeClass('disabled'); //此处修改 $('li:first', an[i]).removeClass('disabled');
                        }

                        if ( oPaging.iPage === oPaging.iTotalPages-1 || oPaging.iTotalPages === 0 ) {
                            $('li:gt(-3)', an[i]).addClass('disabled'); //此处修改 $('li:last', an[i]).addClass('disabled');
                        } else {
                            $('li:gt(-3)', an[i]).removeClass('disabled'); //此处修改 $('li:last', an[i]).removeClass('disabled');
                        }
                    }
                }
            }
        } );
        
        /*
        *   执行 初始化函数
        * */
        //$("#tableId").dataTable().fnDestroy();//清除表格
        initDataTables();
        
        
        /*
         * 初始化表格
         * */
        function initDataTables() {
            $("#tableId").removeClass('dataTable');// 没有黑线了, 也没有排序icon
            var tableOptions = {
                "language": {
                    search: '<span class="label label-success">搜索：</span>',//右上角的搜索文本，可以写html标签
                    "sProcessing": "正在获取数据，请稍后... sProcessing....",
                    "sLengthMenu": "每页显示 _MENU_ 条",
                    "sZeroRecords": "没有找到数据 sZeroRecords...", // 表格内显示
                    "sInfo": "从 _START_ 到  _END_ 条记录, 总数为 _TOTAL_ 条",
                    "sInfoEmpty": "记录数为0 sInfoEmpty...", // 代替 sInfo
                    "sInfoFiltered": "(全部记录数 _MAX_ 条)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索",
                    "sUrl": "",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上一页",
                        "sNext": "下一页",
                        "sLast": "尾页"
                    },
                    "oAria": {
                        "sSortAscending": ": 升序排列",
                        "sSortDescending": ": 降序排列"
                    },
                },
            };
            var self = {
                //scrollY: 500,
                //"aLengthMenu": [3, 10, 20, 30, 60, 80], // 选择每页加载的数据量
                //"paging": true, // 页容量
                //"lengthChange": true, // 也是选择页容量

                "pageLength": 10,// 默认每页加载条数
                //"iDisplayLength": 2,// -> 每次请求，显示多少条数据
                //"iDisplayStart": 0, // -> 每次请求，第一条数据从哪里开始，这个2个会传到后端

                "searching": false, // 查找
                //"bInfo": true,//页脚 左边记录 信息
                "pagingType": "full_numbers",// 分页

                //"dom": '<l<\'#topPlugin\'>f>rt<ip><"clear">',
                initComplete: initComplete, // 添加dom 的方法
                drawCallback: drawCallback, // 表格加载完毕后执行的方法

                "ordering": true, // 全局排序 - true: 全选框有icon
                "order": [[ 2, "asc" ]], //默认排序
                "sort": "position",
                "deferRender": true, // -> 延迟渲染
                "bStateSave": true, // -> 删除记录之后，跳到第一页
                "bAutoWidth": true, // -> 自动适应宽度
                "bServerSide": false,// -> 服务端模式
                "bProcessing": false,// -> 进度： 点击下一页的进度显示
                "processing": false,// -> 进度：'sProcessing'顶部显示 loading...
                // 刷新后回到第一页
                renderer: "bootstrap",

                //"ajax": "data.json",
                "sAjaxSource": "orthogonalData.json",
                "fnServerData": retrieveData, //与后台交互获取数据的处理函数
                columns: [
                    { data: "name" },
                    { data: "position" },
                    { data: "office" },
                    { data: "extn" },
                    { data: {
                        _:    "start_date.display",
                        sort: "start_date.timestamp"
                    } },
                    { data: "salary" }
                ],
                
                // event
                
            }
            var obj = $.extend(true, {}, tableOptions, self);
            $('#tableId').DataTable(obj);
            $("#tableId_filter input[type=search]").css({width: "auto"});//右上角的默认搜索文本框，不写这个就超出去了。
        };
        
        /*
         *   追加dom, ? dom的位置
         *   @param  data
         * */
        function initComplete(data) {
            var topPlugin = '<button class="btn btn-danger btn-sm" id="deleteAll">批量删除</button> ' +
                '<button   class="btn btn-primary btn-sm addBtn" >新 增</button> ' +
                '<iframe id="exp" style="display:none;"></iframe>' +
                '<button  class="btn btn-info btn-sm" id="expCsv">导出全部</button> ' +
                '<button  class="btn btn-warning btn-sm" id="reset">重置搜索条件</button>';
            $("#topPlugin").append(topPlugin);//在表格上方topPlugin DIV中追加HTML
            //$("#expCsv").on("click", exp1);//给下方按钮绑定事件
        };
        
        /*
         *   表格加载完毕，执行回调
         *   @param  settings
         * */
        function drawCallback(settings) {
            //alert(123);
        };
        
        /*
         *   ajax 函数
         *   @param  sSource, aoData, fnCallback
         * */
        function retrieveData(sSource, aoData, fnCallback) {
            //获取查询条件并与aoData合并
            $.ajax({
                url: sSource,//这个就是请求地址对应sAjaxSource
                data: aoData,//这个是把datatable的一些基本数据传给后台,比如起始位置,每页显示的行数
                type: 'get',
                dataType: 'json',
                async: false,
                success: function (res) {
                    console.log(res);
                    fnCallback(res)
                    //成功返回结果后的处理
                }
            });
        };
        
        
        /*
         * datePicker
         * */
        $('.datepicker').datepicker({
            format: 'yyyy/mm/dd',
            startDate: '3d'
        });

        $('#event_period').datepicker({
            inputs: $('.actual_range')
        });
    });


</script>
